<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê°œì¸ë¶„ì„ - ë§›ì§‘ ì¶”ì²œ ì„œë¹„ìŠ¤</title>
    <link rel="stylesheet" href="common.css">
    <style>
        body {
            padding-bottom: 80px;
            background: var(--gray-50);
        }

        .profile-header {
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-blue-dark));
            color: white;
            padding: var(--space-8) var(--space-4);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .profile-header::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100px;
            height: 100px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            transform: translate(30px, -30px);
        }

        .profile-avatar {
            width: 80px;
            height: 80px;
            border-radius: var(--radius-full);
            background: rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            margin: 0 auto var(--space-4);
            border: 3px solid rgba(255, 255, 255, 0.3);
        }

        .profile-name {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: var(--space-1);
        }

        .profile-stats {
            display: flex;
            justify-content: center;
            gap: var(--space-6);
            opacity: 0.9;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-size: 18px;
            font-weight: 700;
            display: block;
        }

        .stat-label {
            font-size: 12px;
            opacity: 0.8;
        }

        .dashboard-section {
            margin: var(--space-6) 0;
            padding: 0 var(--space-4);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-4);
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--gray-900);
        }

        .section-action {
            color: var(--primary-blue);
            font-size: 12px;
            text-decoration: none;
            font-weight: 500;
        }

        /* ê°€ì„±ë¹„ ê¸°ì¤€ ì°¨íŠ¸ */
        .value-criteria-card {
            background: var(--white);
            border-radius: var(--radius-lg);
            padding: var(--space-6);
            box-shadow: var(--shadow-md);
            margin-bottom: var(--space-4);
        }

        .radar-chart {
            width: 200px;
            height: 200px;
            margin: 0 auto var(--space-4);
            position: relative;
            background: conic-gradient(
                from 0deg,
                var(--primary-blue-light) 0deg 90deg,
                var(--food-orange-light) 90deg 180deg,
                var(--success-green) 180deg 270deg,
                var(--warning-yellow) 270deg 360deg
            );
            border-radius: var(--radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .radar-chart::before {
            content: '';
            width: 120px;
            height: 120px;
            background: var(--white);
            border-radius: var(--radius-full);
            position: absolute;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .radar-center {
            position: relative;
            z-index: 1;
            text-align: center;
        }

        .overall-score {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary-blue);
            display: block;
        }

        .score-label {
            font-size: 12px;
            color: var(--gray-500);
        }

        .factor-legends {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-4);
        }

        .factor-legend {
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }

        .factor-color {
            width: 12px;
            height: 12px;
            border-radius: var(--radius-sm);
        }

        .factor-color.price { background: var(--primary-blue-light); }
        .factor-color.portion { background: var(--food-orange-light); }
        .factor-color.taste { background: var(--success-green); }
        .factor-color.service { background: var(--warning-yellow); }

        .factor-text {
            font-size: 12px;
            color: var(--gray-700);
            font-weight: 500;
        }

        .factor-score {
            font-size: 12px;
            font-weight: 600;
            color: var(--gray-900);
            margin-left: auto;
        }

        /* ìµœê·¼ í‰ê°€ */
        .recent-evaluations {
            background: var(--white);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-md);
            overflow: hidden;
        }

        .evaluation-item {
            padding: var(--space-4);
            border-bottom: 1px solid var(--gray-100);
            display: flex;
            gap: var(--space-3);
        }

        .evaluation-item:last-child {
            border-bottom: none;
        }

        .evaluation-image {
            width: 50px;
            height: 50px;
            border-radius: var(--radius-md);
            object-fit: cover;
            flex-shrink: 0;
        }

        .evaluation-content {
            flex: 1;
        }

        .evaluation-restaurant {
            font-size: 14px;
            font-weight: 600;
            color: var(--gray-900);
            margin-bottom: var(--space-1);
        }

        .evaluation-date {
            font-size: 11px;
            color: var(--gray-500);
            margin-bottom: var(--space-2);
        }

        .evaluation-scores {
            display: flex;
            gap: var(--space-2);
        }

        .score-badge {
            background: var(--gray-100);
            color: var(--gray-700);
            padding: var(--space-1) var(--space-2);
            border-radius: var(--radius-sm);
            font-size: 10px;
            font-weight: 500;
        }

        .score-badge.excellent {
            background: var(--success-green);
            color: white;
        }

        .score-badge.good {
            background: var(--primary-blue);
            color: white;
        }

        /* ì„±ê³¼ ë°°ì§€ */
        .achievements {
            background: var(--white);
            border-radius: var(--radius-lg);
            padding: var(--space-4);
            box-shadow: var(--shadow-md);
        }

        .achievement-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: var(--space-4);
            margin-top: var(--space-4);
        }

        .achievement-item {
            text-align: center;
            padding: var(--space-3);
            border-radius: var(--radius-lg);
            background: var(--gray-50);
            transition: all 0.2s ease;
        }

        .achievement-item.unlocked {
            background: var(--primary-blue-light);
        }

        .achievement-icon {
            font-size: 24px;
            margin-bottom: var(--space-1);
        }

        .achievement-name {
            font-size: 10px;
            font-weight: 500;
            color: var(--gray-700);
        }

        .achievement-item.unlocked .achievement-name {
            color: var(--primary-blue-dark);
            font-weight: 600;
        }

        /* ì¶”ì²œ ì •í™•ë„ */
        .accuracy-card {
            background: var(--white);
            border-radius: var(--radius-lg);
            padding: var(--space-5);
            box-shadow: var(--shadow-md);
            text-align: center;
        }

        .accuracy-circle {
            width: 120px;
            height: 120px;
            border-radius: var(--radius-full);
            background: conic-gradient(var(--success-green) 0deg 288deg, var(--gray-200) 288deg 360deg);
            margin: 0 auto var(--space-4);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .accuracy-circle::before {
            content: '';
            width: 80px;
            height: 80px;
            background: var(--white);
            border-radius: var(--radius-full);
            position: absolute;
        }

        .accuracy-percentage {
            font-size: 24px;
            font-weight: 700;
            color: var(--success-green);
            z-index: 1;
        }

        .accuracy-description {
            font-size: 12px;
            color: var(--gray-600);
            line-height: 1.5;
        }

        /* ì„¤ì • ì„¹ì…˜ */
        .settings-section {
            background: var(--white);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-md);
            overflow: hidden;
        }

        .setting-item {
            display: flex;
            align-items: center;
            padding: var(--space-4);
            border-bottom: 1px solid var(--gray-100);
            text-decoration: none;
            color: var(--gray-900);
            transition: background-color 0.2s ease;
        }

        .setting-item:last-child {
            border-bottom: none;
        }

        .setting-item:hover {
            background: var(--gray-50);
        }

        .setting-icon {
            font-size: 18px;
            margin-right: var(--space-3);
            color: var(--gray-500);
        }

        .setting-content {
            flex: 1;
        }

        .setting-title {
            font-size: 14px;
            font-weight: 500;
            margin-bottom: var(--space-1);
        }

        .setting-description {
            font-size: 12px;
            color: var(--gray-500);
        }

        .setting-arrow {
            color: var(--gray-400);
            font-size: 12px;
        }

        /* ë¹ˆ ìƒíƒœ */
        .empty-state {
            text-align: center;
            padding: var(--space-8);
            color: var(--gray-500);
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: var(--space-4);
            opacity: 0.5;
        }

        .empty-state-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: var(--space-2);
        }

        .empty-state-description {
            font-size: 14px;
            line-height: 1.5;
            margin-bottom: var(--space-4);
        }

        .empty-state-action {
            background: var(--primary-blue);
            color: white;
            padding: var(--space-3) var(--space-6);
            border-radius: var(--radius-lg);
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
        }
    </style>
</head>
<body>
    <!-- í”„ë¡œí•„ í—¤ë” -->
    <div class="profile-header">
        <div class="profile-avatar">ğŸ‘¤</div>
        <div class="profile-name" id="profileName">ìŒì‹ íƒí—˜ê°€</div>
        <div class="profile-stats">
            <div class="stat-item">
                <span class="stat-number" id="evaluationCount">0</span>
                <span class="stat-label">í‰ê°€</span>
            </div>
            <div class="stat-item">
                <span class="stat-number" id="visitCount">0</span>
                <span class="stat-label">ë°©ë¬¸</span>
            </div>
            <div class="stat-item">
                <span class="stat-number" id="badgeCount">0</span>
                <span class="stat-label">ë°°ì§€</span>
            </div>
        </div>
    </div>

    <!-- ê°€ì„±ë¹„ ê¸°ì¤€ ì„¹ì…˜ -->
    <div class="dashboard-section">
        <div class="section-header">
            <h2 class="section-title">ë‚˜ì˜ ê°€ì„±ë¹„ ê¸°ì¤€</h2>
            <a href="#" class="section-action">ìƒì„¸ë³´ê¸°</a>
        </div>

        <div class="value-criteria-card" id="valueCriteriaCard">
            <!-- ë¡œë”© ë˜ëŠ” ë°ì´í„° í‘œì‹œ -->
        </div>
    </div>

    <!-- ìµœê·¼ í‰ê°€ ì„¹ì…˜ -->
    <div class="dashboard-section">
        <div class="section-header">
            <h2 class="section-title">ìµœê·¼ í‰ê°€</h2>
            <a href="#" class="section-action">ì „ì²´ë³´ê¸°</a>
        </div>

        <div class="recent-evaluations" id="recentEvaluations">
            <!-- JavaScriptë¡œ ë™ì  ìƒì„± -->
        </div>
    </div>

    <!-- ì„±ê³¼ ë°°ì§€ ì„¹ì…˜ -->
    <div class="dashboard-section">
        <div class="section-header">
            <h2 class="section-title">ì„±ê³¼ ë°°ì§€</h2>
            <a href="#" class="section-action">ì „ì²´ë³´ê¸°</a>
        </div>

        <div class="achievements">
            <div class="achievement-grid" id="achievementGrid">
                <!-- JavaScriptë¡œ ë™ì  ìƒì„± -->
            </div>
        </div>
    </div>

    <!-- ì¶”ì²œ ì •í™•ë„ ì„¹ì…˜ -->
    <div class="dashboard-section">
        <div class="section-header">
            <h2 class="section-title">ì¶”ì²œ ì •í™•ë„</h2>
        </div>

        <div class="accuracy-card">
            <div class="accuracy-circle">
                <span class="accuracy-percentage" id="accuracyRate">-%</span>
            </div>
            <div class="accuracy-description">
                ë‚´ê°€ í‰ê°€í•œ ì‹ë‹¹ ì¤‘ <strong>ì¶”ì²œ ë§›ì§‘ê³¼ ì¼ì¹˜í•˜ëŠ” ë¹„ìœ¨</strong><br>
                ë” ë§ì€ í‰ê°€ë¥¼ í†µí•´ ì •í™•ë„ë¥¼ ë†’ì¼ ìˆ˜ ìˆì–´ìš”
            </div>
        </div>
    </div>

    <!-- ì„¤ì • ì„¹ì…˜ -->
    <div class="dashboard-section">
        <div class="section-header">
            <h2 class="section-title">ì„¤ì •</h2>
        </div>

        <div class="settings-section">
            <a href="#" class="setting-item">
                <div class="setting-icon">ğŸ””</div>
                <div class="setting-content">
                    <div class="setting-title">ì•Œë¦¼ ì„¤ì •</div>
                    <div class="setting-description">ìƒˆë¡œìš´ ë§›ì§‘ ì¶”ì²œ, í‰ê°€ ë¦¬ë§ˆì¸ë“œ</div>
                </div>
                <div class="setting-arrow">â€º</div>
            </a>

            <a href="#" class="setting-item">
                <div class="setting-icon">ğŸ¯</div>
                <div class="setting-content">
                    <div class="setting-title">ì¶”ì²œ ê¸°ì¤€ ì¡°ì •</div>
                    <div class="setting-description">ê°€ê²©ëŒ€, ì„ í˜¸ ìŒì‹, ê±°ë¦¬ ë“±</div>
                </div>
                <div class="setting-arrow">â€º</div>
            </a>

            <a href="#" class="setting-item">
                <div class="setting-icon">ğŸ“Š</div>
                <div class="setting-content">
                    <div class="setting-title">ë°ì´í„° ë‚´ë³´ë‚´ê¸°</div>
                    <div class="setting-description">í‰ê°€ ë‚´ì—­ ë° ë¶„ì„ ë°ì´í„°</div>
                </div>
                <div class="setting-arrow">â€º</div>
            </a>

            <a href="#" class="setting-item">
                <div class="setting-icon">â“</div>
                <div class="setting-content">
                    <div class="setting-title">ë„ì›€ë§</div>
                    <div class="setting-description">ì‚¬ìš©ë²• ë° ìì£¼ ë¬»ëŠ” ì§ˆë¬¸</div>
                </div>
                <div class="setting-arrow">â€º</div>
            </a>
        </div>
    </div>

    <!-- í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ -->
    <div class="bottom-nav">
        <div class="bottom-nav-content">
            <a href="#" class="bottom-nav-item" onclick="Utils.navigateTo('01-í™ˆí™”ë©´')">
                <div class="bottom-nav-icon">ğŸ </div>
                <div class="bottom-nav-label">í™ˆ</div>
            </a>
            <a href="#" class="bottom-nav-item" onclick="Utils.navigateTo('02-ê²€ìƒ‰ê²°ê³¼')">
                <div class="bottom-nav-icon">ğŸ”</div>
                <div class="bottom-nav-label">ê²€ìƒ‰</div>
            </a>
            <a href="#" class="bottom-nav-item" onclick="Utils.navigateTo('06-ì£¼ë¬¸ìƒíƒœ')">
                <div class="bottom-nav-icon">ğŸ½ï¸</div>
                <div class="bottom-nav-label">ì£¼ë¬¸</div>
            </a>
            <a href="#" class="bottom-nav-item active">
                <div class="bottom-nav-icon">ğŸ‘¤</div>
                <div class="bottom-nav-label">ë‚´ ì •ë³´</div>
            </a>
        </div>
    </div>

    <script src="common.js"></script>
    <script>
        // í˜ì´ì§€ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', () => {
            initializeAnalysisPage();
        });

        function initializeAnalysisPage() {
            loadUserProfile();
            loadValueCriteria();
            loadRecentEvaluations();
            loadAchievements();
            calculateAccuracy();
        }

        // ì‚¬ìš©ì í”„ë¡œí•„ ë¡œë“œ
        function loadUserProfile() {
            const evaluationHistory = Utils.storage.get('evaluationHistory') || [];
            const userProfile = Utils.storage.get('userProfile') || {
                name: 'ìŒì‹ íƒí—˜ê°€',
                evaluationCount: 0,
                visitCount: 0,
                badgeCount: 0
            };

            // í”„ë¡œí•„ ì—…ë°ì´íŠ¸
            document.getElementById('profileName').textContent = userProfile.name;
            document.getElementById('evaluationCount').textContent = evaluationHistory.length;
            document.getElementById('visitCount').textContent = evaluationHistory.length; // ê°„ì†Œí™”
            document.getElementById('badgeCount').textContent = calculateBadgeCount(evaluationHistory);
        }

        // ê°€ì„±ë¹„ ê¸°ì¤€ ë¡œë“œ
        function loadValueCriteria() {
            const evaluationHistory = Utils.storage.get('evaluationHistory') || [];
            const container = document.getElementById('valueCriteriaCard');

            if (evaluationHistory.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">ğŸ“Š</div>
                        <div class="empty-state-title">ì•„ì§ í‰ê°€ê°€ ì—†ì–´ìš”</div>
                        <div class="empty-state-description">
                            ì‹ë‹¹ì„ ë°©ë¬¸í•˜ê³  í‰ê°€í•´ì£¼ì‹œë©´<br>ê°œì¸ ë§ì¶¤ ê°€ì„±ë¹„ ê¸°ì¤€ì„ ë¶„ì„í•´ë“œë¦´ê²Œìš”
                        </div>
                        <a href="#" class="empty-state-action" onclick="Utils.navigateTo('01-í™ˆí™”ë©´')">
                            ë§›ì§‘ ì°¾ì•„ë³´ê¸°
                        </a>
                    </div>
                `;
                return;
            }

            const criteria = calculateValueCriteria(evaluationHistory);

            container.innerHTML = `
                <div class="radar-chart">
                    <div class="radar-center">
                        <span class="overall-score">${criteria.overall.toFixed(1)}</span>
                        <span class="score-label">ì¢…í•© ì ìˆ˜</span>
                    </div>
                </div>
                <div class="factor-legends">
                    <div class="factor-legend">
                        <div class="factor-color price"></div>
                        <div class="factor-text">ê°€ê²©</div>
                        <div class="factor-score">${criteria.price.toFixed(1)}</div>
                    </div>
                    <div class="factor-legend">
                        <div class="factor-color portion"></div>
                        <div class="factor-text">ì–‘</div>
                        <div class="factor-score">${criteria.portion.toFixed(1)}</div>
                    </div>
                    <div class="factor-legend">
                        <div class="factor-color taste"></div>
                        <div class="factor-text">ë§›</div>
                        <div class="factor-score">${criteria.taste.toFixed(1)}</div>
                    </div>
                    <div class="factor-legend">
                        <div class="factor-color service"></div>
                        <div class="factor-text">ì„œë¹„ìŠ¤</div>
                        <div class="factor-score">${criteria.service.toFixed(1)}</div>
                    </div>
                </div>
            `;
        }

        // ìµœê·¼ í‰ê°€ ë¡œë“œ
        function loadRecentEvaluations() {
            const evaluationHistory = Utils.storage.get('evaluationHistory') || [];
            const container = document.getElementById('recentEvaluations');

            if (evaluationHistory.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">ğŸ“</div>
                        <div class="empty-state-title">ì•„ì§ í‰ê°€í•œ ì‹ë‹¹ì´ ì—†ì–´ìš”</div>
                        <div class="empty-state-description">
                            ì‹ë‹¹ì„ ë°©ë¬¸í•˜ê³  ê°€ì„±ë¹„ë¥¼ í‰ê°€í•´ë³´ì„¸ìš”
                        </div>
                    </div>
                `;
                return;
            }

            // ìµœê·¼ 5ê°œë§Œ í‘œì‹œ
            const recentEvaluations = evaluationHistory.slice(-5).reverse();

            container.innerHTML = recentEvaluations.map(evaluation => `
                <div class="evaluation-item">
                    <img src="${evaluation.restaurantImage || 'https://picsum.photos/50/50?random=' + evaluation.id}"
                         alt="${evaluation.restaurantName}"
                         class="evaluation-image">
                    <div class="evaluation-content">
                        <div class="evaluation-restaurant">${evaluation.restaurantName}</div>
                        <div class="evaluation-date">${formatEvaluationDate(evaluation.date)}</div>
                        <div class="evaluation-scores">
                            <div class="score-badge ${getScoreClass(evaluation.factors.price)}">
                                ê°€ê²© ${evaluation.factors.price}
                            </div>
                            <div class="score-badge ${getScoreClass(evaluation.factors.taste)}">
                                ë§› ${evaluation.factors.taste}
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // ì„±ê³¼ ë°°ì§€ ë¡œë“œ
        function loadAchievements() {
            const evaluationHistory = Utils.storage.get('evaluationHistory') || [];
            const container = document.getElementById('achievementGrid');

            const achievements = [
                { id: 'first_review', name: 'ì²« í‰ê°€', icon: 'ğŸ‰', unlocked: evaluationHistory.length >= 1 },
                { id: 'reviewer', name: 'ë¦¬ë·°ì–´', icon: 'âœï¸', unlocked: evaluationHistory.length >= 5 },
                { id: 'foodie', name: 'í‘¸ë””', icon: 'ğŸ½ï¸', unlocked: evaluationHistory.length >= 10 },
                { id: 'explorer', name: 'íƒí—˜ê°€', icon: 'ğŸ—ºï¸', unlocked: getUniqueRestaurants(evaluationHistory) >= 5 },
                { id: 'critic', name: 'ë¯¸ì‹ê°€', icon: 'â­', unlocked: getHighRatingCount(evaluationHistory) >= 3 },
                { id: 'bargain_hunter', name: 'ê°€ì„±ë¹„ì™•', icon: 'ğŸ’°', unlocked: getValueRatingCount(evaluationHistory) >= 5 }
            ];

            container.innerHTML = achievements.map(achievement => `
                <div class="achievement-item ${achievement.unlocked ? 'unlocked' : ''}">
                    <div class="achievement-icon">${achievement.icon}</div>
                    <div class="achievement-name">${achievement.name}</div>
                </div>
            `).join('');
        }

        // ì¶”ì²œ ì •í™•ë„ ê³„ì‚°
        function calculateAccuracy() {
            const evaluationHistory = Utils.storage.get('evaluationHistory') || [];
            const accuracyElement = document.getElementById('accuracyRate');

            if (evaluationHistory.length < 3) {
                accuracyElement.textContent = '-%';
                return;
            }

            // ê°„ë‹¨í•œ ì •í™•ë„ ê³„ì‚° (ì‹¤ì œë¡œëŠ” ë” ë³µì¡í•œ ì•Œê³ ë¦¬ì¦˜ ì‚¬ìš©)
            const highSatisfactionCount = evaluationHistory.filter(e =>
                (e.factors.price + e.factors.portion + e.factors.taste + e.factors.service) / 4 >= 4.0
            ).length;

            const accuracy = Math.round((highSatisfactionCount / evaluationHistory.length) * 100);
            accuracyElement.textContent = `${accuracy}%`;

            // ì›í˜• ì°¨íŠ¸ ì—…ë°ì´íŠ¸
            const circle = document.querySelector('.accuracy-circle');
            const degree = (accuracy / 100) * 360;
            circle.style.background = `conic-gradient(var(--success-green) 0deg ${degree}deg, var(--gray-200) ${degree}deg 360deg)`;
        }

        // ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë“¤
        function calculateValueCriteria(evaluations) {
            if (evaluations.length === 0) {
                return { price: 0, portion: 0, taste: 0, service: 0, overall: 0 };
            }

            const totals = evaluations.reduce((acc, eval) => ({
                price: acc.price + eval.factors.price,
                portion: acc.portion + eval.factors.portion,
                taste: acc.taste + eval.factors.taste,
                service: acc.service + eval.factors.service
            }), { price: 0, portion: 0, taste: 0, service: 0 });

            const count = evaluations.length;
            const criteria = {
                price: totals.price / count,
                portion: totals.portion / count,
                taste: totals.taste / count,
                service: totals.service / count
            };

            criteria.overall = (criteria.price + criteria.portion + criteria.taste + criteria.service) / 4;

            return criteria;
        }

        function calculateBadgeCount(evaluations) {
            const achievements = [
                evaluations.length >= 1,  // ì²« í‰ê°€
                evaluations.length >= 5,  // ë¦¬ë·°ì–´
                evaluations.length >= 10, // í‘¸ë””
                getUniqueRestaurants(evaluations) >= 5,  // íƒí—˜ê°€
                getHighRatingCount(evaluations) >= 3,    // ë¯¸ì‹ê°€
                getValueRatingCount(evaluations) >= 5    // ê°€ì„±ë¹„ì™•
            ];

            return achievements.filter(Boolean).length;
        }

        function getUniqueRestaurants(evaluations) {
            const uniqueRestaurants = new Set(evaluations.map(e => e.restaurantId));
            return uniqueRestaurants.size;
        }

        function getHighRatingCount(evaluations) {
            return evaluations.filter(e => {
                const avgRating = (e.factors.price + e.factors.portion + e.factors.taste + e.factors.service) / 4;
                return avgRating >= 4.5;
            }).length;
        }

        function getValueRatingCount(evaluations) {
            return evaluations.filter(e => e.factors.price >= 4.0).length;
        }

        function formatEvaluationDate(dateString) {
            const date = new Date(dateString);
            const now = new Date();
            const diffInDays = Math.floor((now - date) / (1000 * 60 * 60 * 24));

            if (diffInDays === 0) return 'ì˜¤ëŠ˜';
            if (diffInDays === 1) return 'ì–´ì œ';
            if (diffInDays < 7) return `${diffInDays}ì¼ ì „`;
            if (diffInDays < 30) return `${Math.floor(diffInDays / 7)}ì£¼ ì „`;
            return `${Math.floor(diffInDays / 30)}ê°œì›” ì „`;
        }

        function getScoreClass(score) {
            if (score >= 4.5) return 'excellent';
            if (score >= 3.5) return 'good';
            return '';
        }

        // í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„± (ê°œë°œìš©)
        function generateTestData() {
            const testEvaluations = [
                {
                    id: 'eval1',
                    restaurantId: 'r1',
                    restaurantName: 'ë§›ìˆëŠ” ê¹€ì¹˜ì°Œê°œ',
                    restaurantImage: 'https://picsum.photos/50/50?random=1',
                    date: new Date(Date.now() - 1000 * 60 * 60 * 24).toISOString(), // 1ì¼ ì „
                    factors: { price: 4.5, portion: 4.2, taste: 4.3, service: 4.1 },
                    overallSatisfaction: 4.3
                },
                {
                    id: 'eval2',
                    restaurantId: 'r2',
                    restaurantName: 'íŒŒìŠ¤íƒ€ í•˜ìš°ìŠ¤',
                    restaurantImage: 'https://picsum.photos/50/50?random=2',
                    date: new Date(Date.now() - 1000 * 60 * 60 * 24 * 3).toISOString(), // 3ì¼ ì „
                    factors: { price: 3.5, portion: 4.0, taste: 4.2, service: 3.8 },
                    overallSatisfaction: 3.9
                }
            ];

            Utils.storage.set('evaluationHistory', testEvaluations);
            initializeAnalysisPage();
        }

        // ê°œë°œìš© í…ŒìŠ¤íŠ¸ ë°ì´í„° ë²„íŠ¼ (ì‹¤ì œ ë°°í¬ì‹œ ì œê±°)
        if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
            const testButton = document.createElement('button');
            testButton.textContent = 'í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„±';
            testButton.style.position = 'fixed';
            testButton.style.top = '10px';
            testButton.style.right = '10px';
            testButton.style.zIndex = '9999';
            testButton.style.padding = '8px 12px';
            testButton.style.background = '#ff4444';
            testButton.style.color = 'white';
            testButton.style.border = 'none';
            testButton.style.borderRadius = '4px';
            testButton.style.fontSize = '12px';
            testButton.onclick = generateTestData;
            document.body.appendChild(testButton);
        }
    </script>
</body>
</html>